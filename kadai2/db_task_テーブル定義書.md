# レシート販売管理システム テーブル定義書

## テーブル一覧

|No.|論理テーブル名|物理テーブル名|概要|
|----|----|----|----|
|1|イートインテーブル|eat_in|イートイン処理のためのテーブル|
|2|従業員テーブル|employee|従業員情報のテーブル|
|3|支払い方法テーブル|payment|支払い方法を定義するテーブル|
|4|商品テーブル|product|商品情報のテーブル|
|5|レシート明細テーブル|rec_detail|レシート明細のテーブル|
|6|レシート支払い方法テーブル|rec_pay|レシートごとの支払い方法テーブル(一度の会計で複数の支払い法を利用するためのテーブル)|
|7|レシートテーブル|receipt|レシートのためのテーブル|
|8|店舗テーブル|shop|各店舗情報のテーブル|
|9|税率テーブル|tax|税率定義のテーブル|

***

## 1. イートインテーブル
物理テーブル名: eat_in  
補足: レシート明細テーブルから参照される。

|No.|論理名|物理名|型|制約|定義内容|
|----|----|----|----|----|----|
|1|イートインフラッグ|eat_in_flag|integer|主キー|1:イートイン 0:持ち帰り|
|2|イートイン税率|eat_in_rate|integer||イートインの税率定義|

## 2. 従業員テーブル
物理テーブル名: employee  
補足: レシートテーブルから参照される。  
 今回はあくまで仮想的なレシート販売管理システムのDB設計のため、従業員の情報(住所、生年月日、性別等)は省略。

|No.|論理名|物理名|型|制約|定義内容|
|----|----|----|----|----|----|
|1|従業員ID|e_id|integer|主キー|全社員に一意に割り当てられるID|
|2|店舗ID|s_id|integer|外部キー(shop(s_id))|従業員の働く店舗のID|
|3|責任者No|resp_no|varchar(20)||レシートに印刷される責任者No。各店舗の社員に重複なく割り当てられている。|

## 3. 支払い方法テーブル
物理テーブル名: payment  
補足: レシート支払い方法テーブルから参照される。  
支払い方法を定義する。

|No.|論理名|物理名|型|制約|定義内容|
|----|----|----|----|----|----|
|1|支払いID|pay_id|integer|主キー||
|2|支払い方法|pay_name|varchar(30)||支払い方法を定義する|

## 4. 製品テーブル
物理テーブル名: product  
補足: レシート明細テーブルから参照される。
商品情報を定義する。

|No.|論理名|物理名|型|制約|定義内容|
|----|----|----|----|----|----|
|1|商品ID|p_id|integer|主キー|商品に一意に割り当てられるID|
|2|商品名|p_name|varchar(100)||商品名|
|3|価格|price|integer||商品の価格|
|4|軽減税率フラグ|t_id|integer|外部キー(tax(t_id))|軽減税率対象判別フラグ|

## 5.レシート明細テーブル
物理テーブル名: rec_detail  
補足: 一枚のレシート内の各商品についての明細を定義する。

|No.|論理名|物理名|型|制約|定義内容|
|----|----|----|----|----|----|
|1|明細ID|d_id|integer|主キー|各明細に一意に割り当てられるID|
|2|レシートID|r_id|integer|外部キー(receipt(r_id))|レシートを特定するためのID|
|3|商品ID|p_id|integer|外部キー(product(p_id))|商品を特定するためのID|
|4|個数|piece|integer||商品の購入個数|
|5|割引額|discount|integer||割引額|
|6|イートインフラグ|eat_in_flag|integer|外部キー(eat_in(eat_in_flag))|イートインか判別するフラグ|


## 6. レシート支払い方法テーブル
物理テーブル名: rec_pay  
補足: レシートごとの支払い方法を定義する。このテーブルにより一回の決済で複数の支払い方法を併用できる。

|No.|論理名|物理名|型|制約|定義内容|
|----|----|----|----|----|----|
|1|レシートID|r_id|integer|主キー・外部キー(receipt(r_id))|レシートを特定するためのID|
|2|支払いID|pay_id|integer|主キー・外部キー(payment(pay_id))|支払い方法を特定するためのID|
|3|支払額|p_amount|integer||支払額を定義|

## 7. レシートテーブル
物理テーブル名: receipt  
補足: rec_detailテーブル、rec_payテーブルから参照される。各レシートを定義する。

|No.|論理名|物理名|型|制約|定義内容|
|----|----|----|----|----|----|
|1|レシートID|r_id|integer|主キー|レシートに一意に割り当てられたID|
|2|伝票番号|order_no|varchar(30)|||
|3|発行年月日|r_date|date||レシート発行年月日|
|4|発行時間|r_time|time||レシート発行時間|
|5|従業員ID|e_id|integer|外部キー(employee(e_id))|レジ操作をした従業員ID|
|6|レジNo|regi_no|integer||会計処理をしたレジ番号|

## 8.店舗テーブル
物理テーブル名: shop  
補足: employeeテーブルから参照される。店舗情報を定義する。

|No.|論理名|物理名|型|制約|定義内容|
|----|----|----|----|----|----|
|1|店舗ID|s_id|integer|主キー|店舗ごとに一意のID|
|2|店舗名|s_name|varchar(30)|||
|3|店舗住所|s_address|VARCHAR(100)|||
|4|店舗電話番号|s_tel|varchar(50)|||

## 9.税率テーブル
物理テーブル名: tax  
補足: productテーブルから参照される。軽減税率かそうでないかを定義する。

|No.|論理名|物理名|型|制約|定義内容|
|----|----|----|----|----|----|
|1|税率ID|t_id|integer|主キー|0: 軽減税率非対象 1:軽減税率対象|
|2|税率|rate|integer||税率を定義|
